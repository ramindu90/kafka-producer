@App:name(\u0027bmcriteria-71\u0027)\n@App:description(\u0027Publication Filtering Application\u0027)\n\n@sink(type \u003d \"inMemory\", topic \u003d \"publication-output\", @map(type \u003d \"passThrough\"))\n@sink(type \u003d \"log\", \n\t@map(type \u003d \"json\", fail.on.missing.attribute \u003d \"false\", enclosing.element \u003d \"$\",\n\t@payload(\"\"\"{\"app\": \"plt-rt\", \"source\":\"bmcriteria-71\",\"level\": \"trace\", \"event\": \"message_processed\",\"metadata\":{\"message_id\":\"{{id}}\",\"data_type\":\"Publication\",\"publication\":\"{{publication}}\",\"action\":\"create\",\"criteria_id\":\"bmcriteria-71\",\"consumer_in_timestamp\":\"{{kafkaConsumerInTS}}\", \"consumer_out_timestamp\":\"{{kafkaConsumerOutTS}}\",\"process_in_timestamp\":\"{{dynamicAppInTS}}\",\"process_out_timestamp\":\"{{dynamicAppOutTS}}\"} } \"\"\")))\ndefine stream ToPublicationOutput (data string, id string, publication string, criteriaId string, kafkaConsumerInTS long, kafkaConsumerOutTS long, dynamicAppInTS long, dynamicAppOutTS long);\n\n@source(type \u003d \"inMemory\", topic \u003d \"publication-input\", @map(type \u003d \"passThrough\"))\n@sink(type \u003d \"log\", \n\t@map(type \u003d \"json\", fail.on.missing.attribute \u003d \"false\", enclosing.element \u003d \"$\",\n\t@payload(\"\"\"{\"app\": \"plt-rt\", \"source\":\"bmcriteria-71\",\"level\": \"trace\", \"event\": \"message_received\",\"metadata\":{\"message_id\":\"{{id}}\",\"data_type\":\"Publication\",\"publication\":\"{{publication}}\",\"action\":\"create\",\"criteria_id\":\"bmcriteria-71\",\"consumer_in_timestamp\":\"{{kafkaConsumerInTS}}\", \"consumer_out_timestamp\":\"{{kafkaConsumerOutTS}}\"} } \"\"\")))\ndefine stream FromPublicationInput (data string, id string, publication string, kafkaConsumerInTS long, kafkaConsumerOutTS long);\n\n@info(name \u003d \"Filter Publications Messages\")\nfrom FromPublicationInput[str:strcmp(\"Gas Daily\", publication) \u003d\u003d 0]\nselect\ndata, id, publication, \u0027bmcriteria-71\u0027 as criteriaId, kafkaConsumerInTS, kafkaConsumerOutTS, eventTimestamp() as dynamicAppInTS, time:timestampInMilliseconds() as dynamicAppOutTS\ninsert into ToPublicationOutput